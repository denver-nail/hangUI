<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>实现逻辑和设计讲解 | hangUI</title>
    <meta name="description" content="组件库">
    <meta name="generator" content="VitePress v1.0.0-rc.44">
    <link rel="preload stylesheet" href="/hangUI/assets/style.J3514ZQn.css" as="style">
    
    <script type="module" src="/hangUI/assets/app.C4S4R-r6.js"></script>
    <link rel="preload" href="/hangUI/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/hangUI/assets/chunks/theme.pDlWk0Zk.js">
    <link rel="modulepreload" href="/hangUI/assets/chunks/framework.DWXGJSoZ.js">
    <link rel="modulepreload" href="/hangUI/assets/tooltip_analyze.md.D3VFWyI7.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-819e58ca><!--[--><!--]--><!--[--><span tabindex="-1" data-v-9fdab438></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-9fdab438> Skip to content </a><!--]--><!----><header class="VPNav" data-v-819e58ca data-v-a7d4646c><div class="VPNavBar" data-v-a7d4646c data-v-301ea174><div class="wrapper" data-v-301ea174><div class="container" data-v-301ea174><div class="title" data-v-301ea174><div class="VPNavBarTitle has-sidebar" data-v-301ea174 data-v-e2fba5a2><a class="title" href="/hangUI/" data-v-e2fba5a2><!--[--><!--]--><!----><span data-v-e2fba5a2>hangUI</span><!--[--><!--]--></a></div></div><div class="content" data-v-301ea174><div class="content-body" data-v-301ea174><!--[--><!--]--><div class="VPNavBarSearch search" data-v-301ea174><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-301ea174 data-v-16134607><span id="main-nav-aria-label" class="visually-hidden" data-v-16134607>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/hangUI/" tabindex="0" data-v-16134607 data-v-32c34250><!--[--><span data-v-32c34250>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/hangUI/markdown-examples.html" tabindex="0" data-v-16134607 data-v-32c34250><!--[--><span data-v-32c34250>Examples</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-301ea174 data-v-5e70cafd><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-5e70cafd data-v-bdae86eb data-v-4e1aad10><span class="check" data-v-4e1aad10><span class="icon" data-v-4e1aad10><!--[--><span class="vpi-sun sun" data-v-bdae86eb></span><span class="vpi-moon moon" data-v-bdae86eb></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-301ea174 data-v-4495f0f8 data-v-eda0a48a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-eda0a48a data-v-501df84b><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-301ea174 data-v-27b93d95 data-v-495692f3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-495692f3><span class="vpi-more-horizontal icon" data-v-495692f3></span></button><div class="menu" data-v-495692f3><div class="VPMenu" data-v-495692f3 data-v-f683709f><!----><!--[--><!--[--><!----><div class="group" data-v-27b93d95><div class="item appearance" data-v-27b93d95><p class="label" data-v-27b93d95>Appearance</p><div class="appearance-action" data-v-27b93d95><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-27b93d95 data-v-bdae86eb data-v-4e1aad10><span class="check" data-v-4e1aad10><span class="icon" data-v-4e1aad10><!--[--><span class="vpi-sun sun" data-v-bdae86eb></span><span class="vpi-moon moon" data-v-bdae86eb></span><!--]--></span></span></button></div></div></div><div class="group" data-v-27b93d95><div class="item social-links" data-v-27b93d95><div class="VPSocialLinks social-links-list" data-v-27b93d95 data-v-eda0a48a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-eda0a48a data-v-501df84b><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-301ea174 data-v-18931360><span class="container" data-v-18931360><span class="top" data-v-18931360></span><span class="middle" data-v-18931360></span><span class="bottom" data-v-18931360></span></span></button></div></div></div></div><div class="divider" data-v-301ea174><div class="divider-line" data-v-301ea174></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-819e58ca data-v-c778aae5><div class="container" data-v-c778aae5><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-c778aae5><span class="vpi-align-left menu-icon" data-v-c778aae5></span><span class="menu-text" data-v-c778aae5>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-c778aae5 data-v-cd9306f9><button data-v-cd9306f9>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-819e58ca data-v-b46d6169><div class="curtain" data-v-b46d6169></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b46d6169><span class="visually-hidden" id="sidebar-aria-label" data-v-b46d6169> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b46d6169><section class="VPSidebarItem level-0" data-v-b46d6169 data-v-b1fa09fd><div class="item" role="button" tabindex="0" data-v-b1fa09fd><div class="indicator" data-v-b1fa09fd></div><h2 class="text" data-v-b1fa09fd>Examples</h2><!----></div><div class="items" data-v-b1fa09fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b1fa09fd data-v-b1fa09fd><div class="item" data-v-b1fa09fd><div class="indicator" data-v-b1fa09fd></div><a class="VPLink link link" href="/hangUI/markdown-examples.html" data-v-b1fa09fd><!--[--><p class="text" data-v-b1fa09fd>Markdown Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b1fa09fd data-v-b1fa09fd><div class="item" data-v-b1fa09fd><div class="indicator" data-v-b1fa09fd></div><a class="VPLink link link" href="/hangUI/api-examples.html" data-v-b1fa09fd><!--[--><p class="text" data-v-b1fa09fd>Runtime API Examples</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-819e58ca data-v-9062f561><div class="VPDoc has-sidebar has-aside" data-v-9062f561 data-v-3a4f2c7d><!--[--><!--]--><div class="container" data-v-3a4f2c7d><div class="aside" data-v-3a4f2c7d><div class="aside-curtain" data-v-3a4f2c7d></div><div class="aside-container" data-v-3a4f2c7d><div class="aside-content" data-v-3a4f2c7d><div class="VPDocAside" data-v-3a4f2c7d data-v-4c859b78><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-4c859b78 data-v-d365a3fb><div class="content" data-v-d365a3fb><div class="outline-marker" data-v-d365a3fb></div><div class="outline-title" role="heading" aria-level="2" data-v-d365a3fb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d365a3fb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d365a3fb> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-d365a3fb data-v-eef2554d><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-4c859b78></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-3a4f2c7d><div class="content-container" data-v-3a4f2c7d><!--[--><!--]--><main class="main" data-v-3a4f2c7d><div style="position:relative;" class="vp-doc _hangUI_tooltip_analyze" data-v-3a4f2c7d><div><h1 id="实现逻辑和设计讲解" tabindex="-1">实现逻辑和设计讲解 <a class="header-anchor" href="#实现逻辑和设计讲解" aria-label="Permalink to &quot;实现逻辑和设计讲解&quot;">​</a></h1><p>这个<code>Tooltip</code>组件是一个用于显示提示信息的UI组件，它提供了丰富的交互和定制化的功能。组件主要基于Vue 3和<code>Popper.js</code>来实现提示框的显示和定位，并且支持不同的触发方式（如悬停、点击等）。下面我将详细讲解其实现逻辑和设计事项。</p><h3 id="_1-组件结构与功能" tabindex="-1">1. 组件结构与功能 <a class="header-anchor" href="#_1-组件结构与功能" aria-label="Permalink to &quot;1. 组件结构与功能&quot;">​</a></h3><h4 id="_1-1-组件属性-props" tabindex="-1">1.1 组件属性（Props） <a class="header-anchor" href="#_1-1-组件属性-props" aria-label="Permalink to &quot;1.1 组件属性（Props）&quot;">​</a></h4><p><code>Tooltip</code>组件提供了一些可配置的属性（<code>props</code>），可以控制组件的行为：</p><ul><li><strong><code>placement</code></strong>: 提示框相对于触发元素的位置，支持的值如 <code>top</code>, <code>bottom</code>, <code>left</code>, <code>right</code> 等，默认值为<code>bottom</code>。</li><li><strong><code>trigger</code></strong>: 控制提示框的触发方式，支持 <code>hover</code>, <code>click</code>, <code>contextmenu</code> 等，默认值为 <code>hover</code>。</li><li><strong><code>transition</code></strong>: 控制提示框出现和消失时的动画效果，默认使用 <code>fade</code>。</li><li><strong><code>showTimeout</code> 和 <code>hideTimeout</code></strong>: 控制在触发事件后，显示或隐藏提示框的延时，适用于 <code>hover</code> 触发方式。</li><li><strong><code>manual</code></strong>: 如果设置为 <code>true</code>，则组件处于手动控制模式，需要外部显式调用 <code>show</code> 或 <code>hide</code> 方法来控制显示与隐藏。</li><li><strong><code>disabled</code></strong>: 如果为 <code>true</code>，禁用提示框的显示功能。</li></ul><h4 id="_1-2-组件事件-emits" tabindex="-1">1.2 组件事件（Emits） <a class="header-anchor" href="#_1-2-组件事件-emits" aria-label="Permalink to &quot;1.2 组件事件（Emits）&quot;">​</a></h4><p>组件触发的事件包括：</p><ul><li><strong><code>visible-change</code></strong>: 组件的可见性变化时触发，参数为 <code>true</code> 或 <code>false</code>。</li><li><strong><code>click-outside</code></strong>: 当点击组件外部时触发，适用于关闭提示框。</li></ul><h4 id="_1-3-组件数据" tabindex="-1">1.3 组件数据 <a class="header-anchor" href="#_1-3-组件数据" aria-label="Permalink to &quot;1.3 组件数据&quot;">​</a></h4><ul><li><strong><code>visible</code></strong>: 一个响应式变量，用于控制提示框的显示与隐藏。</li><li><strong><code>events</code></strong>: 用于存储绑定到触发元素的事件，如 <code>mouseenter</code>, <code>click</code> 等。</li><li><strong><code>outerEvents</code></strong>: 用于存储绑定到外部容器（如外部节点点击事件）的一些事件。</li><li><strong><code>dropdownEvents</code></strong>: 用于存储绑定到提示框本身的事件。</li></ul><h4 id="_1-4-组件行为" tabindex="-1">1.4 组件行为 <a class="header-anchor" href="#_1-4-组件行为" aria-label="Permalink to &quot;1.4 组件行为&quot;">​</a></h4><ul><li><strong><code>visible</code> 控制显示</strong>: 组件通过 <code>visible</code> 控制提示框的显示和隐藏，当 <code>visible</code> 为 <code>true</code> 时，提示框将显示；否则隐藏。</li><li><strong>事件绑定与触发</strong>: 组件根据 <code>trigger</code> 的值来决定绑定哪些事件。例如，<code>hover</code> 触发时会绑定 <code>mouseenter</code> 和 <code>mouseleave</code> 事件；<code>click</code> 触发时会绑定 <code>click</code> 事件；<code>contextmenu</code> 触发时会绑定 <code>contextmenu</code> 事件。</li><li><strong>Popper.js</strong>: 组件使用 <code>Popper.js</code> 来实现提示框相对于触发元素的位置定位。<code>Popper.js</code> 是一个流行的库，用于处理复杂的弹出层定位，能够动态调整位置。</li></ul><h3 id="_2-事件处理与防抖" tabindex="-1">2. 事件处理与防抖 <a class="header-anchor" href="#_2-事件处理与防抖" aria-label="Permalink to &quot;2. 事件处理与防抖&quot;">​</a></h3><h4 id="_2-1-triggerstrategymap-与事件绑定" tabindex="-1">2.1 <code>triggerStrategyMap</code> 与事件绑定 <a class="header-anchor" href="#_2-1-triggerstrategymap-与事件绑定" aria-label="Permalink to &quot;2.1 `triggerStrategyMap` 与事件绑定&quot;">​</a></h4><p><code>triggerStrategyMap</code> 是一个 <code>Map</code> 对象，用来存储不同触发方式下的事件绑定策略。例如：</p><ul><li>对于 <code>hover</code> 触发，绑定了 <code>mouseenter</code> 和 <code>mouseleave</code> 事件，分别用于显示和隐藏提示框。</li><li>对于 <code>click</code> 触发，绑定了 <code>click</code> 事件，通过 <code>togglePopper</code> 函数切换提示框的显示和隐藏状态。</li><li>对于 <code>contextmenu</code> 触发，绑定了右键菜单事件，在触发时显示提示框。</li></ul><p>每个触发方式的事件处理函数都会通过防抖（<code>debounce</code>）来处理延时的显示和隐藏，避免频繁的操作。</p><h4 id="_2-2-防抖" tabindex="-1">2.2 防抖 <a class="header-anchor" href="#_2-2-防抖" aria-label="Permalink to &quot;2.2 防抖&quot;">​</a></h4><p><code>openDebounce</code> 和 <code>closeDebounce</code> 是防抖函数，通过 <code>debounce</code> 和 <code>bind</code> 函数将 <code>setVisible</code> 方法进行包装，控制提示框显示和隐藏的延迟。防抖的目的是避免用户频繁触发事件时，导致提示框频繁显示或隐藏。</p><ul><li><strong><code>openDebounce</code></strong>: 用于防抖后显示提示框。</li><li><strong><code>closeDebounce</code></strong>: 用于防抖后隐藏提示框。</li></ul><h4 id="_2-3-触发外部点击" tabindex="-1">2.3 触发外部点击 <a class="header-anchor" href="#_2-3-触发外部点击" aria-label="Permalink to &quot;2.3 触发外部点击&quot;">​</a></h4><p><code>useClickOutside</code> 是一个自定义 hook，用于监听外部点击事件。当用户点击组件外部时，组件会触发 <code>click-outside</code> 事件，并且在非 <code>hover</code> 或 <code>manual</code> 触发方式下，自动隐藏提示框。</p><h4 id="_2-4-异常处理" tabindex="-1">2.4 异常处理 <a class="header-anchor" href="#_2-4-异常处理" aria-label="Permalink to &quot;2.4 异常处理&quot;">​</a></h4><p>通过 <code>onUnmounted</code> 钩子，在组件卸载时销毁 <code>Popper.js</code> 实例，确保没有资源泄露。</p><h3 id="_3-popper-js-与定位" tabindex="-1">3. <code>Popper.js</code> 与定位 <a class="header-anchor" href="#_3-popper-js-与定位" aria-label="Permalink to &quot;3. `Popper.js` 与定位&quot;">​</a></h3><p>组件使用 <code>Popper.js</code> 来处理提示框的位置。<code>Popper.js</code> 是一个强大的定位库，它可以在提示框的显示位置上进行动态计算，以避免提示框被遮挡或显示错误位置。</p><p>在这个组件中，<code>popperOptions</code> 包含了相关的配置项：</p><ul><li><strong><code>placement</code></strong>: 提示框的显示位置（如 <code>top</code>, <code>bottom</code> 等）。</li><li><strong><code>modifiers</code></strong>: 对提示框位置的调整，如 <code>offset</code> 用于调整提示框与触发元素的间距。</li></ul><p><code>createPopper</code> 函数会根据触发元素和提示框元素来计算并应用定位。</p><h3 id="_4-插槽-slot" tabindex="-1">4. 插槽（Slot） <a class="header-anchor" href="#_4-插槽-slot" aria-label="Permalink to &quot;4. 插槽（Slot）&quot;">​</a></h3><p>组件有两个插槽：</p><ul><li><strong>默认插槽 (<code>default</code>)</strong>: 用于传入触发提示框显示的元素或内容。可以是任意元素。</li><li><strong><code>content</code> 插槽</strong>: 用于定义提示框中显示的内容，可以传入文本或其他组件。</li></ul><p>通过插槽，组件的灵活性得到了提升，允许开发者自定义触发元素和提示框内容。</p><h3 id="_5-动画与过渡" tabindex="-1">5. 动画与过渡 <a class="header-anchor" href="#_5-动画与过渡" aria-label="Permalink to &quot;5. 动画与过渡&quot;">​</a></h3><p>组件使用 Vue 的 <code>&lt;transition&gt;</code> 组件包裹提示框部分，使得提示框在显示和隐藏时具有动画效果。过渡的 <code>name</code> 属性值通过 <code>props.transition</code> 来控制，默认使用 <code>fade</code> 动画。</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transition&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @after-leave</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;destroyPopperInstance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;er-tooltip__popper&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popperNode&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropdownEvents&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;visible&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {{ content }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;arrow&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> data-popper-arrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h3><p>这个<code>Tooltip</code>组件通过 Vue 3 的组合式 API 和 <code>Popper.js</code> 实现了一个功能丰富的提示框。它支持多种触发方式（如 hover、click 和 contextmenu），并且通过防抖处理和 Popper.js 动态定位来优化用户体验。此外，组件通过插槽机制，允许开发者自定义内容和触发元素，增强了其灵活性和可扩展性。</p><hr><h1 id="具体实现讲解" tabindex="-1">具体实现讲解 <a class="header-anchor" href="#具体实现讲解" aria-label="Permalink to &quot;具体实现讲解&quot;">​</a></h1><p>好的，接下来我会详细分析这个 <code>Tooltip</code> 组件的具体实现，逐步解释代码中的每个重要部分，帮助你更好地理解其设计和逻辑。</p><h3 id="_1-组件结构和初始化" tabindex="-1">1. 组件结构和初始化 <a class="header-anchor" href="#_1-组件结构和初始化" aria-label="Permalink to &quot;1. 组件结构和初始化&quot;">​</a></h3><h4 id="_1-1-props-和默认值" tabindex="-1">1.1 <code>props</code> 和默认值 <a class="header-anchor" href="#_1-1-props-和默认值" aria-label="Permalink to &quot;1.1 `props` 和默认值&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> props</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> withDefaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defineProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_TooltipProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(), {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  placement: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bottom&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  trigger: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hover&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transition: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  showTimeout: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  hideTimeout: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><code>defineProps&lt;_TooltipProps&gt;()</code> 用于定义组件的属性，<code>withDefaults()</code> 用于设置默认值。</li><li><strong><code>placement</code></strong>: 控制提示框相对于触发元素的位置，默认设置为 <code>bottom</code>。</li><li><strong><code>trigger</code></strong>: 定义触发方式，默认为 <code>hover</code>，即当鼠标悬停时显示提示框。</li><li><strong><code>transition</code></strong>: 控制过渡效果，默认使用 <code>fade</code> 动画。</li><li><strong><code>showTimeout</code> 和 <code>hideTimeout</code></strong>: 控制提示框显示和隐藏的延时，适用于 <code>hover</code> 触发方式，默认为 <code>0</code> 和 <code>200</code> 毫秒。</li></ul><h4 id="_1-2-visible-响应式变量" tabindex="-1">1.2 <code>visible</code> 响应式变量 <a class="header-anchor" href="#_1-2-visible-响应式变量" aria-label="Permalink to &quot;1.2 `visible` 响应式变量&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> visible</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><ul><li><code>visible</code> 是一个响应式变量，控制提示框的显示或隐藏状态。</li><li>初始值为 <code>false</code>，表示提示框初始不可见。</li></ul><h4 id="_1-3-triggernode-的计算属性" tabindex="-1">1.3 <code>triggerNode</code> 的计算属性 <a class="header-anchor" href="#_1-3-triggernode-的计算属性" aria-label="Permalink to &quot;1.3 `triggerNode` 的计算属性&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> triggerNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (props.virtualTriggering) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (props.virtualRef </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">??</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _triggerNode.value;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _triggerNode.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><code>triggerNode</code> 是一个计算属性，表示触发节点。</li><li>如果设置了 <code>virtualTriggering</code> 为 <code>true</code>，则 <code>triggerNode</code> 会返回 <code>virtualRef</code> 中指定的元素；否则返回 <code>_triggerNode</code> 中的元素。</li><li>这个属性用于指定哪个元素将触发提示框的显示和隐藏。</li></ul><h4 id="_1-4-popperoptions-的计算属性" tabindex="-1">1.4 <code>popperOptions</code> 的计算属性 <a class="header-anchor" href="#_1-4-popperoptions-的计算属性" aria-label="Permalink to &quot;1.4 `popperOptions` 的计算属性&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> popperOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  placement: props.placement,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  modifiers: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;offset&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      options: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        offset: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">props.popperOptions,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}));</span></span></code></pre></div><ul><li><code>popperOptions</code> 用于配置 <code>Popper.js</code> 的定位选项，控制提示框的定位行为。</li><li><code>placement</code> 确定提示框的位置，默认为 <code>bottom</code>。</li><li><code>offset</code> 控制提示框与触发元素之间的间距，这里设置为 <code>[0, 9]</code>，即在垂直方向上有 9px 的间距。</li></ul><h3 id="_2-事件处理与触发方式" tabindex="-1">2. 事件处理与触发方式 <a class="header-anchor" href="#_2-事件处理与触发方式" aria-label="Permalink to &quot;2. 事件处理与触发方式&quot;">​</a></h3><h4 id="_2-1-触发方式映射-triggerstrategymap" tabindex="-1">2.1 触发方式映射 (<code>triggerStrategyMap</code>) <a class="header-anchor" href="#_2-1-触发方式映射-triggerstrategymap" aria-label="Permalink to &quot;2.1 触发方式映射 (`triggerStrategyMap`)&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> triggerStrategyMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">triggerStrategyMap.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hover&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  events.value[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mouseenter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> openFinal;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  outerEvents.value[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mouseleave&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> closeFinal;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dropdownEvents.value[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mouseenter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> openFinal;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">triggerStrategyMap.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  events.value[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> togglePopper;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">triggerStrategyMap.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;contextmenu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  events.value[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;contextmenu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preventDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    openFinal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>triggerStrategyMap</span></span></code></pre></div><p>是一个</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Map</span></span></code></pre></div><p>，它根据不同的触发方式（如</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>hover</span></span></code></pre></div><p>、</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>click</span></span></code></pre></div><p>、</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>contextmenu</span></span></code></pre></div><p>）来设置相应的事件处理函数。</p><ul><li>对于 <code>hover</code> 触发，绑定 <code>mouseenter</code> 和 <code>mouseleave</code> 事件。</li><li>对于 <code>click</code> 触发，绑定 <code>click</code> 事件，用于切换提示框的显示或隐藏。</li><li>对于 <code>contextmenu</code> 触发，绑定右键菜单事件，用于显示提示框。</li></ul></li></ul><h4 id="_2-2-防抖函数-debounce-和-opendebounce-closedebounce" tabindex="-1">2.2 防抖函数 (<code>debounce</code> 和 <code>openDebounce</code> / <code>closeDebounce</code>) <a class="header-anchor" href="#_2-2-防抖函数-debounce-和-opendebounce-closedebounce" aria-label="Permalink to &quot;2.2 防抖函数 (`debounce` 和 `openDebounce` / `closeDebounce`)&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> openDebounce</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DebouncedFunc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> closeDebounce</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DebouncedFunc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><code>openDebounce</code> 和 <code>closeDebounce</code> 是防抖函数，用于延迟显示和隐藏提示框。</li><li>使用 <code>debounce</code> 函数来避免频繁的事件触发，防止提示框在快速触发时频繁显示或隐藏。</li><li>通过 <code>bind(setVisible, null, true)</code> 和 <code>bind(setVisible, null, false)</code> 来包装 <code>setVisible</code> 方法，延迟执行显示和隐藏操作。</li></ul><h4 id="_2-3-显示与隐藏的防抖操作" tabindex="-1">2.3 显示与隐藏的防抖操作 <a class="header-anchor" href="#_2-3-显示与隐藏的防抖操作" aria-label="Permalink to &quot;2.3 显示与隐藏的防抖操作&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> openFinal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  closeDebounce?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  openDebounce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?.();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> closeFinal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  openDebounce?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  closeDebounce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?.();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>openFinal</code> 和 <code>closeFinal</code> 会先取消当前正在执行的防抖操作，然后执行相应的防抖操作来显示或隐藏提示框。</li><li><code>closeDebounce?.cancel()</code> 用于取消当前的关闭防抖操作，<code>openDebounce?.()</code> 执行开启防抖操作。</li></ul><h3 id="_3-外部事件处理与防止外部点击" tabindex="-1">3. 外部事件处理与防止外部点击 <a class="header-anchor" href="#_3-外部事件处理与防止外部点击" aria-label="Permalink to &quot;3. 外部事件处理与防止外部点击&quot;">​</a></h3><h4 id="_3-1-外部点击监听" tabindex="-1">3.1 外部点击监听 <a class="header-anchor" href="#_3-1-外部点击监听" aria-label="Permalink to &quot;3.1 外部点击监听&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useClickOutside</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(containerNode, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  emits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;click-outside&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (props.trigger </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;hover&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> props.manual) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  visible.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> closeFinal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><p><code>useClickOutside</code> 是一个自定义 hook，用于检测点击事件是否发生在组件外部。</p></li><li><p>如果点击的是组件外部，触发</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>click-outside</span></span></code></pre></div><p>事件，并且根据</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>trigger</span></span></code></pre></div><p>类型决定是否隐藏提示框。</p><ul><li>如果是 <code>hover</code> 或 <code>manual</code> 触发方式，点击外部不会隐藏提示框。</li></ul></li></ul><h4 id="_3-2-触发节点的事件处理" tabindex="-1">3.2 触发节点的事件处理 <a class="header-anchor" href="#_3-2-触发节点的事件处理" aria-label="Permalink to &quot;3.2 触发节点的事件处理&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useEvenstToTiggerNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(props, triggerNode, events, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  openDebounce?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setVisible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><code>useEvenstToTiggerNode</code> 是另一个自定义 hook，处理触发节点的事件。</li><li>它绑定了相应的事件并且在某些情况下（例如触发外部点击）会隐藏提示框。</li></ul><h3 id="_4-popper-js-实例与定位" tabindex="-1">4. <code>Popper.js</code> 实例与定位 <a class="header-anchor" href="#_4-popper-js-实例与定位" aria-label="Permalink to &quot;4. `Popper.js` 实例与定位&quot;">​</a></h3><h4 id="_4-1-创建-popper-实例" tabindex="-1">4.1 创建 Popper 实例 <a class="header-anchor" href="#_4-1-创建-popper-实例" aria-label="Permalink to &quot;4.1 创建 Popper 实例&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  visible,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (triggerNode.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> popperNode.value) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      popperInstance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createPopper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        triggerNode.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        popperNode.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        popperOptions.value</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { flush: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;post&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><ul><li>当 <code>visible</code> 变为 <code>true</code> 时，组件会创建 <code>Popper.js</code> 实例。</li><li><code>createPopper</code> 用于生成提示框的位置和定位，这会基于触发节点和提示框的 DOM 元素来计算。</li></ul><h4 id="_4-2-销毁-popper-实例" tabindex="-1">4.2 销毁 Popper 实例 <a class="header-anchor" href="#_4-2-销毁-popper-实例" aria-label="Permalink to &quot;4.2 销毁 Popper 实例&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> destroyPopperInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  popperInstance?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  popperInstance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>destroyPopperInstance</code> 用于销毁 <code>Popper.js</code> 实例，避免内存泄漏。</li><li>这个方法在组件销毁时调用，确保资源被清理。</li></ul><h3 id="_5-动画与过渡-1" tabindex="-1">5. 动画与过渡 <a class="header-anchor" href="#_5-动画与过渡-1" aria-label="Permalink to &quot;5. 动画与过渡&quot;">​</a></h3><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transition&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @after-leave</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;destroyPopperInstance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;er-tooltip__popper&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popperNode&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropdownEvents&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;visible&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {{ content }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;arrow&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> data-popper-arrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>通过 <code>&lt;transition&gt;</code> 标签来处理提示框的显示与隐藏动画。</li><li>过渡效果的 <code>name</code> 通过 <code>props.transition</code> 控制，默认为 <code>fade</code>，在隐藏时触发 <code>@after-leave</code> 钩子调用 <code>destroyPopperInstance</code>，销毁 <code>Popper</code> 实例。</li></ul><h3 id="总结-1" tabindex="-1">总结 <a class="header-anchor" href="#总结-1" aria-label="Permalink to &quot;总结&quot;">​</a></h3><p>这个 <code>Tooltip</code> 组件设计非常灵活，利用 Vue 3 的组合式 API 处理了各种触发方式、动画效果、外部点击等情况。核心逻辑包括：</p><ul><li>动态绑定事件处理（如 <code>mouseenter</code>、<code>click</code> 等），</li><li>防抖处理，避免频繁的显示/隐藏操作，</li><li><code>Popper.js</code> 用于动态定位提示框，</li><li>外部点击和事件管理。</li></ul><p>这个实现可以适应多种使用场景，并且具有良好的可定制性。</p><hr><h1 id="poper使用讲解" tabindex="-1">Poper使用讲解 <a class="header-anchor" href="#poper使用讲解" aria-label="Permalink to &quot;Poper使用讲解&quot;">​</a></h1><p>在这个 <code>Tooltip</code> 组件中，<code>Popper.js</code> 被用来进行动态的定位和排列提示框，使其能够根据触发元素的位置进行精确的定位。<code>Popper.js</code> 是一个强大的库，专门用于处理弹出元素（如提示框、下拉菜单等）的定位和显示，确保它们总是出现在目标元素的适当位置上，并避免遮挡或溢出。</p><h3 id="_1-popper-js-的初始化与使用" tabindex="-1">1. <strong>Popper.js 的初始化与使用</strong> <a class="header-anchor" href="#_1-popper-js-的初始化与使用" aria-label="Permalink to &quot;1. **Popper.js 的初始化与使用**&quot;">​</a></h3><p><code>Popper.js</code> 在该组件中主要通过 <code>createPopper</code> 函数进行初始化和定位，它被用来将提示框（tooltip）元素与触发元素（trigger）关联，并根据 <code>placement</code> 和其他配置选项调整其位置。</p><h4 id="_1-1-popperinstance-的声明" tabindex="-1">1.1 <code>popperInstance</code> 的声明 <a class="header-anchor" href="#_1-1-popperinstance-的声明" aria-label="Permalink to &quot;1.1 `popperInstance` 的声明&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> popperInstance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li><code>popperInstance</code> 用于保存 <code>Popper.js</code> 实例，实例化后，它将控制提示框的位置和行为。</li><li><code>Instance</code> 是 <code>Popper.js</code> 的类型定义，用于表示 <code>Popper</code> 的实例。</li></ul><h4 id="_1-2-popperoptions-的计算属性" tabindex="-1">1.2 <code>popperOptions</code> 的计算属性 <a class="header-anchor" href="#_1-2-popperoptions-的计算属性" aria-label="Permalink to &quot;1.2 `popperOptions` 的计算属性&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> popperOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  placement: props.placement,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  modifiers: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;offset&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      options: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        offset: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">props.popperOptions,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}));</span></span></code></pre></div><ul><li><code>popperOptions</code> 是一个计算属性，它定义了 <code>Popper.js</code> 的配置项。</li><li><strong><code>placement</code></strong>: 这个选项控制提示框的定位方式，决定了提示框相对于触发元素的位置。它由 <code>props.placement</code> 提供，默认为 <code>bottom</code>，表示提示框显示在触发元素的下方。</li><li><strong><code>modifiers</code></strong>: <code>Popper.js</code> 支持多个修饰符（modifiers）来修改定位行为。其中 <code>offset</code> 修饰符用于控制提示框与触发元素之间的间距，<code>offset: [0, 9]</code> 表示提示框与触发元素的垂直距离为 9 像素。</li><li><code>...props.popperOptions</code>: 允许外部传入自定义的 <code>Popper</code> 配置，进一步扩展和定制。</li></ul><h4 id="_1-3-createpopper-的调用" tabindex="-1">1.3 <code>createPopper</code> 的调用 <a class="header-anchor" href="#_1-3-createpopper-的调用" aria-label="Permalink to &quot;1.3 `createPopper` 的调用&quot;">​</a></h4><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  visible,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (triggerNode.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> popperNode.value) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      popperInstance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createPopper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        triggerNode.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        popperNode.value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        popperOptions.value</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { flush: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;post&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><ul><li><p>监听 <code>visible</code> 变量的变化（即提示框的显示状态）。</p></li><li><p>当 <code>visible</code> 为 <code>true</code> 时，检查 <code>triggerNode</code> 和 <code>popperNode</code> 是否存在，然后调用 <code>createPopper</code> 来初始化 <code>Popper.js</code> 实例。</p></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>createPopper(trigger, popper, options)</span></span></code></pre></div><p>用于创建</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Popper.js</span></span></code></pre></div><p>实例，其中：</p><ul><li><code>triggerNode.value</code> 是触发元素，它会作为定位参考点。</li><li><code>popperNode.value</code> 是实际显示的提示框元素，它将根据 <code>triggerNode</code> 的位置进行定位。</li><li><code>popperOptions.value</code> 是 <code>Popper.js</code> 的配置项，定义了定位方式和修饰符。</li></ul></li></ul><h3 id="_2-popper-js-的定位与显示" tabindex="-1">2. <strong>Popper.js 的定位与显示</strong> <a class="header-anchor" href="#_2-popper-js-的定位与显示" aria-label="Permalink to &quot;2. **Popper.js 的定位与显示**&quot;">​</a></h3><p><code>Popper.js</code> 通过 <strong><code>triggerNode</code></strong> 和 <strong><code>popperNode</code></strong> 的位置关系来决定提示框的位置。每当提示框显示（<code>visible = true</code>），<code>Popper.js</code> 会根据以下配置来定位提示框：</p><ul><li><strong><code>placement</code></strong>: 控制提示框的默认位置。例如，如果 <code>placement</code> 为 <code>bottom</code>，则提示框将显示在触发元素的下方；如果为 <code>top</code>，则显示在上方。</li><li><strong><code>offset</code></strong>: 控制提示框相对于触发元素的偏移量。在这个实现中，<code>offset</code> 被设置为 <code>[0, 9]</code>，即提示框与触发元素之间在垂直方向上有 9 像素的间隔。</li><li><strong><code>popperOptions</code></strong>: 外部传入的 <code>Popper.js</code> 配置选项可以进一步定制定位行为。</li></ul><h3 id="_3-popper-实例的销毁" tabindex="-1">3. <strong>Popper 实例的销毁</strong> <a class="header-anchor" href="#_3-popper-实例的销毁" aria-label="Permalink to &quot;3. **Popper 实例的销毁**&quot;">​</a></h3><p>为了避免内存泄漏或多余的实例在组件销毁时继续存在，组件提供了销毁 <code>Popper.js</code> 实例的机制：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> destroyPopperInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  popperInstance?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  popperInstance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>destroyPopperInstance</code> 会销毁当前的 <code>Popper.js</code> 实例，并将 <code>popperInstance</code> 置为 <code>null</code>。</li><li>这个方法会在组件销毁时或者提示框隐藏时调用，确保 <code>Popper.js</code> 实例被正确清理。</li></ul><h3 id="_4-过渡与销毁" tabindex="-1">4. <strong>过渡与销毁</strong> <a class="header-anchor" href="#_4-过渡与销毁" aria-label="Permalink to &quot;4. **过渡与销毁**&quot;">​</a></h3><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transition&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @after-leave</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;destroyPopperInstance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;er-tooltip__popper&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popperNode&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dropdownEvents&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;visible&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {{ content }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;arrow&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> data-popper-arrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">transition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>提示框的显示和隐藏使用了 Vue 的 <code>&lt;transition&gt;</code> 标签来处理动画效果，<code>transition</code> 的 <code>@after-leave</code> 钩子会在提示框隐藏时调用 <code>destroyPopperInstance</code>，销毁 <code>Popper.js</code> 实例。</li><li><code>popperNode</code> 是提示框的实际元素，<code>v-if=&quot;visible&quot;</code> 用于控制提示框的显示和隐藏。</li><li><code>data-popper-arrow</code> 用于 <code>Popper.js</code> 箭头定位的占位符，<code>Popper.js</code> 会根据箭头元素自动调整提示框的箭头位置，使其始终指向触发元素。</li></ul><h3 id="_5-总结-popper-js-的使用" tabindex="-1">5. <strong>总结 Popper.js 的使用</strong> <a class="header-anchor" href="#_5-总结-popper-js-的使用" aria-label="Permalink to &quot;5. **总结 Popper.js 的使用**&quot;">​</a></h3><p><code>Popper.js</code> 在该组件中的主要作用是负责提示框的位置和箭头的动态定位。通过以下几个方面，<code>Popper.js</code> 实现了精准的提示框位置控制：</p><ul><li><strong>创建和初始化</strong>: <code>createPopper</code> 根据触发元素和提示框元素的 DOM 节点创建实例。</li><li><strong>定位与修饰</strong>: <code>placement</code> 和 <code>offset</code> 控制提示框的显示位置，确保它相对于触发元素正确显示。</li><li><strong>动态更新</strong>: 当提示框的显示状态变化时（例如 <code>visible</code> 改变），<code>Popper.js</code> 会重新计算并调整提示框的位置。</li><li><strong>清理和销毁</strong>: 在组件销毁或提示框隐藏时，<code>destroyPopperInstance</code> 被调用，确保销毁 <code>Popper.js</code> 实例并释放资源。</li></ul><p>通过 <code>Popper.js</code> 的使用，<code>Tooltip</code> 组件能够在不同的屏幕和浏览器窗口大小下，始终确保提示框与触发元素之间的正确相对位置，同时避免了遮挡和溢出问题，使得提示框更加稳定和灵活。</p></div></div></main><footer class="VPDocFooter" data-v-3a4f2c7d data-v-993038d6><!--[--><!--]--><!----><nav class="prev-next" data-v-993038d6><div class="pager" data-v-993038d6><!----></div><div class="pager" data-v-993038d6><a class="VPLink link pager-link next" href="/hangUI/markdown-examples.html" data-v-993038d6><!--[--><span class="desc" data-v-993038d6>Next page</span><span class="title" data-v-993038d6>Markdown Examples</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"BT4nrpqQ\",\"index.md\":\"ChFqLKC9\",\"markdown-examples.md\":\"bgM1IA5Z\",\"tooltip_analyze.md\":\"D3VFWyI7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"hangUI\",\"description\":\"组件库\",\"base\":\"/hangUI/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Examples\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>